# Dashboard Services
# Homepage and Homarr for homelab dashboards
# Place in /opt/stacks/dashboards/docker-compose.yml

# Service Access URLs:
# - Homepage: https://home.${DOMAIN}
# - Homarr: https://homarr.${DOMAIN}

services:
  # Homepage - Application dashboard (AI-configurable via YAML)
  # Access at: https://home.${DOMAIN}
  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: homepage
    restart: unless-stopped
    networks:
      - homelab-network
      - traefik-network
      - dockerproxy-network
    volumes:
      - ./homepage:/app/config
      - /var/run/docker.sock:/var/run/docker.sock:ro  # For Docker integration
      - /opt/stacks:/opt/stacks:ro  # To discover other stacks
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ}
      - HOMEPAGE_ALLOWED_HOSTS=home.${DOMAIN}
    labels:
      - "homelab.category=dashboard"
      - "homelab.description=Application dashboard (AI-configurable)"
      - "traefik.enable=true"
      - "traefik.http.routers.homepage.rule=Host(`home.${DOMAIN}`)"
      - "traefik.http.routers.homepage.entrypoints=websecure"
      - "traefik.http.routers.homepage.tls=true"
      - "traefik.http.routers.homepage.middlewares=authelia@docker"
      - "traefik.http.services.homepage.loadbalancer.server.port=3000"

  # Homarr - Modern dashboard
  # Access at: https://homarr.${DOMAIN}
  homarr:
    image: ghcr.io/ajnart/homarr:latest
    container_name: homarr
    restart: unless-stopped
    networks:
      - homelab-network
      - traefik-network
    volumes:
      - ./homarr/config:/app/config/configs
      - ./homarr/data:/data
      - ./homarr/icons:/app/public/icons
      - /var/run/docker.sock:/var/run/docker.sock:ro
    environment:
      - TZ=${TZ}
    labels:
      - "homelab.category=dashboard"
      - "homelab.description=Modern homelab dashboard"
      - "traefik.enable=true"
      - "traefik.http.routers.homarr.rule=Host(`homarr.${DOMAIN}`)"
      - "traefik.http.routers.homarr.entrypoints=websecure"
      - "traefik.http.routers.homarr.tls=true"
      - "traefik.http.routers.homarr.middlewares=authelia@docker"
      - "traefik.http.services.homarr.loadbalancer.server.port=7575"

networks:
  homelab-network:
    external: true
  traefik-network:
    external: true
  dockerproxy-network:
    external: true
